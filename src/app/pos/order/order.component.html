<div class="flex flex-col h-screen bg-gray-50 relative overflow-hidden">
  
  <header class="bg-white shadow-sm px-4 py-3 sticky top-0 z-40 flex justify-between items-center border-b border-gray-200">
    <div class="flex flex-col">
      <div class="flex items-center gap-2">
        <h1 class="font-bold text-gray-800 text-lg leading-tight">
          {{ isCartOpen ? 'üõí Mon Panier' : 'üçΩÔ∏è Carte' }}
        </h1>
        <span *ngIf="cart.length > 0" class="bg-orange-100 text-orange-700 text-[10px] font-bold px-2 py-0.5 rounded-full border border-orange-200 animate-pulse">
          En cours
        </span>
      </div>
      <p class="text-xs text-gray-500">Table {{ tableNumber || 'Inconnue' }} <span *ngIf="tableId" class="opacity-50 text-[10px]">({{tableId | slice:0:4}}...)</span></p>
    </div>
    
    <button *ngIf="isCartOpen" (click)="toggleCart()" class="text-blue-600 font-medium text-sm bg-blue-50 px-3 py-1 rounded-full">
      Fermer
    </button>
  </header>

  <main class="flex-1 overflow-y-auto p-4 pb-32 z-0"> 
    
    <div *ngIf="!isCartOpen" class="grid grid-cols-2 gap-3 animate-fadeIn">
      <div *ngFor="let product of menuProducts" 
           (click)="addToCart(product)"
           class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center text-center active:scale-95 transition-transform cursor-pointer relative overflow-hidden group">
        
        <div class="absolute inset-0 bg-blue-50 opacity-0 group-hover:opacity-20 transition-opacity"></div>
        
        <div class="text-4xl mb-2 transform group-hover:scale-110 transition-transform">{{ product.image }}</div>
        <div class="font-bold text-gray-700 text-sm leading-tight">{{ product.name }}</div>
        <div class="text-blue-600 font-bold text-xs mt-1 bg-blue-50 px-2 py-0.5 rounded-full">{{ product.price }} DT</div>
      </div>
    </div>

    <div *ngIf="isCartOpen" class="animate-slideIn">
      <div *ngFor="let item of cart" class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-3 flex justify-between items-center">
        <div>
          <div class="font-bold text-gray-800">{{ item.name }}</div>
          <div class="text-xs text-gray-500 mt-0.5">Qt√©: <span class="font-bold text-gray-900">{{ item.quantity }}</span></div>
        </div>
        <div class="font-bold text-gray-900 text-lg">{{ item.price * item.quantity | number:'1.2-2' }} <span class="text-xs font-normal text-gray-500">DT</span></div>
      </div>
      
      <div class="mt-6 border-t border-gray-200 pt-4 px-2">
         <div class="flex justify-between items-center mb-2 text-gray-500 text-sm">
           <span>Sous-total</span>
           <span>{{ totalPrice | number:'1.2-2' }} DT</span>
         </div>
         <div class="flex justify-between items-center font-bold text-xl text-gray-900">
           <span>Total</span>
           <span>{{ totalPrice | number:'1.2-2' }} DT</span>
         </div>
      </div>
    </div>

  </main>

  <footer *ngIf="cart.length > 0" 
          class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-[0_-5px_25px_rgba(0,0,0,0.15)] z-50 p-4 transition-transform duration-300">
    
    <div class="max-w-xl mx-auto">
      
      <div *ngIf="!isCartOpen" class="flex justify-between items-end mb-3 px-1 animate-fadeIn">
        <span class="text-[10px] text-gray-500 uppercase tracking-wider font-bold">Total commande</span>
        <span class="text-xl font-black text-gray-900 leading-none">{{ totalPrice | number:'1.2-2' }} <span class="text-sm font-normal text-gray-400">DT</span></span>
      </div>

      <button (click)="toggleCart()" 
              [class.bg-blue-600]="!isCartOpen" 
              [class.hover:bg-blue-700]="!isCartOpen"
              [class.bg-green-600]="isCartOpen"
              [class.hover:bg-green-700]="isCartOpen"
              class="w-full text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center relative overflow-visible group">
        
        <span *ngIf="!isCartOpen" class="flex items-center gap-2">üìù Voir la commande</span>
        <span *ngIf="isCartOpen" class="flex items-center gap-2">‚úÖ Valider / Payer</span>

        <span *ngIf="!isCartOpen" 
              class="absolute -top-3 -right-2 bg-red-600 text-white text-xs font-bold w-8 h-8 flex items-center justify-center rounded-full border-4 border-white shadow-md animate-bounce">
          {{ totalItems }}
        </span>

      </button>
    </div>
  </footer>

</div>
